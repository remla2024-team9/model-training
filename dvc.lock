schema: '2.0'
stages:
  load_data:
    cmd: python3 src/data_loader.py data/raw/train_sample.txt data/interim/loaded_data.txt
    deps:
    - path: data/raw/train.txt
      hash: md5
      md5: 13fd241a41370119612d5b00b0433009
      size: 93921671
    - path: src/data_loader.py
      hash: md5
      md5: a03d3c929a25cf1e05b8f94b9d7c458e
      size: 619
    outs:
    - path: data/interim/loaded_data.txt
      hash: md5
      md5: aa3239d8309b0c915f6254a22a6fe55b
      size: 4480205
  tokenize_data:
    cmd: python3 src/preprocess.py data/interim/loaded_data.txt data/interim/tokenized_data.txt
      data/interim/tokenizer.json
    deps:
    - path: data/interim/loaded_data.txt
      hash: md5
      md5: aa3239d8309b0c915f6254a22a6fe55b
      size: 4480205
    - path: src/preprocess.py
      hash: md5
      md5: 65a1298032517c2c4077ec3bfeba6d89
      size: 1273
    outs:
    - path: data/interim/tokenized_data.txt
      hash: md5
      md5: 9c87c2864f87847f3afcfc65919795c5
      size: 22404263
    - path: data/interim/tokenizer.json
      hash: md5
      md5: ea5cccf92734d696eba432deb1dc68b8
      size: 6543
  encode_labels:
    cmd: python src/encode_labels.py data/interim/train_labels.txt data/interim/val_labels.txt
      data/interim/test_labels.txt
    deps:
    - path: data/interim/test_labels.txt
      hash: md5
      md5: ee87127d4d350f71855f7645118a14e2
      size: 3681252
    - path: data/interim/train_labels.txt
      hash: md5
      md5: a1baa255faeadb22c2b820464989699e
      size: 10570508
    - path: data/interim/val_labels.txt
      hash: md5
      md5: e1b4662a77e310d40d02a627f0a5e26c
      size: 5206339
    - path: src/encode_labels.py
      hash: md5
      md5: 568b7942e11bb04bd00aa33d1c5ded96
      size: 1224
    outs:
    - path: data/interim/encoded_test_labels.txt
      hash: md5
      md5: 007f8877f2c5b4d9f90d235d7e03c1f9
      size: 728396
    - path: data/interim/encoded_train_labels.txt
      hash: md5
      md5: 3c9cb692e19bd045164e352003cc67e6
      size: 2091548
    - path: data/interim/encoded_val_labels.txt
      hash: md5
      md5: 410cc6b6c2e8f6a109fa103ae8b27665
      size: 1030158
  split_train_data:
    cmd: python src/data_split.py data/raw/train.txt data/interim/train_features.txt
      data/interim/train_labels.txt
    deps:
    - path: data/raw/train.txt
      hash: md5
      md5: 13fd241a41370119612d5b00b0433009
      size: 93921671
    - path: src/data_split.py
      hash: md5
      md5: f3af203f622eaff800ad537be693f073
      size: 1285
    outs:
    - path: data/interim/train_features.txt
      hash: md5
      md5: e30e89161e21482d56537c6d0889db94
      size: 84396770
    - path: data/interim/train_labels.txt
      hash: md5
      md5: a2628fb8ca50c89fe1250772b8a50206
      size: 11616282
  split_test_data:
    cmd: python src/data_split.py data/raw/test.txt data/interim/test_features.txt
      data/interim/test_labels.txt
    deps:
    - path: data/raw/test.txt
      hash: md5
      md5: a1cab28ad8554fd9269d31e5708469d0
      size: 32724891
    - path: src/data_split.py
      hash: md5
      md5: ee14f0c9ff3996ba3980aaf9eafa5d35
      size: 942
    outs:
    - path: data/interim/test_features.txt
      hash: md5
      md5: 609e75fbf12e4f1ac9bdc1e40bf8c028
      size: 29043540
    - path: data/interim/test_labels.txt
      hash: md5
      md5: ee87127d4d350f71855f7645118a14e2
      size: 3681252
  split_val_data:
    cmd: python src/data_split.py data/raw/val.txt data/interim/val_features.txt data/interim/val_labels.txt
    deps:
    - path: data/raw/val.txt
      hash: md5
      md5: 7b1e28b1e91582c6f36e85517c3cc6ee
      size: 46258330
    - path: src/data_split.py
      hash: md5
      md5: ee14f0c9ff3996ba3980aaf9eafa5d35
      size: 942
    outs:
    - path: data/interim/val_features.txt
      hash: md5
      md5: c74e4e1c602207a00f9a7d0b6f5cd612
      size: 41051954
    - path: data/interim/val_labels.txt
      hash: md5
      md5: e1b4662a77e310d40d02a627f0a5e26c
      size: 5206339
  tokenize_features:
    cmd: python src/tokenize_features.py data/interim/train_features.txt data/interim/val_features.txt
      data/interim/test_features.txt
    deps:
    - path: data/interim/test_features.txt
      hash: md5
      md5: 609e75fbf12e4f1ac9bdc1e40bf8c028
      size: 29043540
    - path: data/interim/train_features.txt
      hash: md5
      md5: 761b3fe3977c171bc5451c08d217f9cb
      size: 83350996
    - path: data/interim/val_features.txt
      hash: md5
      md5: c74e4e1c602207a00f9a7d0b6f5cd612
      size: 41051954
    - path: src/tokenize_features.py
      hash: md5
      md5: a470d5f82b0f99aaddac3dfa67275277
      size: 1562
    outs:
    - path: data/interim/tokenized_test.txt
      hash: md5
      md5: 2baccef67e75786951222165a3233b90
      size: 161985941
    - path: data/interim/tokenized_train.txt
      hash: md5
      md5: 25c0b60a1a875a217ff8ed300c1e5288
      size: 465127361
    - path: data/interim/tokenized_val.txt
      hash: md5
      md5: 509a8b29d340e3a4478b036197fda971
      size: 229090761
    - path: data/interim/tokenizer.pkl
      hash: md5
      md5: e7df067c1e0e925a88e63ff16c8b6228
      size: 2402
  download_data:
    cmd: python src/data_downloader.py
    deps:
    - path: src/data_downloader.py
      hash: md5
      md5: 4a2b0dd03fc37ce12666bc33c7dce6a4
      size: 1764
    outs:
    - path: data/raw/test.txt
      hash: md5
      md5: a1cab28ad8554fd9269d31e5708469d0
      size: 32724891
    - path: data/raw/train.txt
      hash: md5
      md5: 13fd241a41370119612d5b00b0433009
      size: 93921671
    - path: data/raw/val.txt
      hash: md5
      md5: 7b1e28b1e91582c6f36e85517c3cc6ee
      size: 46258330
  train_model:
    cmd: python src/train_model.py
    deps:
    - path: data/interim/encoded_train_labels.txt
      hash: md5
      md5: 3c9cb692e19bd045164e352003cc67e6
      size: 2091548
    - path: data/interim/encoded_val_labels.txt
      hash: md5
      md5: 410cc6b6c2e8f6a109fa103ae8b27665
      size: 1030158
    - path: data/interim/tokenized_train.txt
      hash: md5
      md5: 25c0b60a1a875a217ff8ed300c1e5288
      size: 465127361
    - path: data/interim/tokenized_val.txt
      hash: md5
      md5: 509a8b29d340e3a4478b036197fda971
      size: 229090761
    - path: src/train_model.py
      hash: md5
      md5: fc0c55e89136dac451299c809a4d65d0
      size: 2343
    params:
      params.yaml:
        batch_test: 5000
        batch_train: 5000
        categories:
        - phishing
        - legitimate
        embedding_dimension: 50
        epoch: 1
        loss_function: binary_crossentropy
        optimizer: adam
    outs:
    - path: models/model.keras
      hash: md5
      md5: fc44d16fbe5a65c32299c539cbb8b690
      size: 5493632
    - path: reports/loss_plot.svg
      hash: md5
      md5: 85713170db6370197dd958529a4cfc44
      size: 21680
    - path: reports/metrics.json
      hash: md5
      md5: 454acd2645ac9e7a5bb21e57a50fbfc6
      size: 137
  test_model:
    cmd: python src/test_model.py
    deps:
    - path: data/interim/test_features.txt
      hash: md5
      md5: 609e75fbf12e4f1ac9bdc1e40bf8c028
      size: 29043540
    - path: data/interim/test_labels.txt
      hash: md5
      md5: ee87127d4d350f71855f7645118a14e2
      size: 3681252
    - path: models/best_model.keras
      hash: md5
      md5: 0abe882e92de1e1ad31d035e5404dd8b
      size: 5472086
    - path: src/test_model.py
      hash: md5
      md5: 59e0a529913014f5b40d868375c5ba30
      size: 1519
    outs:
    - path: reports/classification_report.txt
      hash: md5
      md5: 8c819104d1e89faf6a01c14c4c6af79a
      size: 349
    - path: reports/confusion_matrix.txt
      hash: md5
      md5: c3f9477728b0ddbe646cdf9dc8fdfb24
      size: 52
    - path: reports/test_accuracy.txt
      hash: md5
      md5: d15c416ee8d03040380eb1d30f2a8e05
      size: 34
    - path: reports/test_loss.txt
      hash: md5
      md5: 71e73c5246d00c793494fa3b702eb32a
      size: 31
