schema: '2.0'
stages:
  load_data:
    cmd: python3 src/data_loader.py data/raw/train_sample.txt data/interim/loaded_data.txt
    deps:
    - path: data/raw/train.txt
      hash: md5
      md5: 13fd241a41370119612d5b00b0433009
      size: 93921671
    - path: src/data_loader.py
      hash: md5
      md5: a03d3c929a25cf1e05b8f94b9d7c458e
      size: 619
    outs:
    - path: data/interim/loaded_data.txt
      hash: md5
      md5: aa3239d8309b0c915f6254a22a6fe55b
      size: 4480205
  tokenize_data:
    cmd: python3 src/preprocess.py data/interim/loaded_data.txt data/interim/tokenized_data.txt
      data/interim/tokenizer.json
    deps:
    - path: data/interim/loaded_data.txt
      hash: md5
      md5: aa3239d8309b0c915f6254a22a6fe55b
      size: 4480205
    - path: src/preprocess.py
      hash: md5
      md5: 65a1298032517c2c4077ec3bfeba6d89
      size: 1273
    outs:
    - path: data/interim/tokenized_data.txt
      hash: md5
      md5: 9c87c2864f87847f3afcfc65919795c5
      size: 22404263
    - path: data/interim/tokenizer.json
      hash: md5
      md5: ea5cccf92734d696eba432deb1dc68b8
      size: 6543
  encode_labels:
    cmd: python src/encode_labels.py data/interim/train_labels.txt data/interim/val_labels.txt
      data/interim/test_labels.txt
    deps:
    - path: data/interim/test_labels.txt
      hash: md5
      md5: 2e3c9d7f5cfbbbaa9ab11e95747c6b88
      size: 4045450
    - path: data/interim/train_labels.txt
      hash: md5
      md5: a2628fb8ca50c89fe1250772b8a50206
      size: 11616282
    - path: data/interim/val_labels.txt
      hash: md5
      md5: 3c330979d7cb08758fcd9d6feaf6aa04
      size: 5721418
    - path: src/encode_labels.py
      hash: md5
      md5: dac89efb2832e1e0f1e0fdcd1718dd96
      size: 1256
    outs:
    - path: data/interim/encoded_test_labels.txt
      hash: md5
      md5: e63840a0a77819d56aa5405a746e5925
      size: 1092594
    - path: data/interim/encoded_train_labels.txt
      hash: md5
      md5: 9f7db0ed64bb77128caa33b3402f97b5
      size: 3137322
    - path: data/interim/encoded_val_labels.txt
      hash: md5
      md5: 36263c753dd478a0eb9165e9a5f988ae
      size: 1545237
  split_train_data:
    cmd: python src/data_split.py data/raw/train.txt data/interim/train_features.txt
      data/interim/train_labels.txt
    deps:
    - path: data/raw/train.txt
      hash: md5
      md5: 13fd241a41370119612d5b00b0433009
      size: 93921671
    - path: src/data_split.py
      hash: md5
      md5: c06a0947ef4f354295f0d5582b305208
      size: 968
    outs:
    - path: data/interim/train_features.txt
      hash: md5
      md5: e30e89161e21482d56537c6d0889db94
      size: 84396770
    - path: data/interim/train_labels.txt
      hash: md5
      md5: a2628fb8ca50c89fe1250772b8a50206
      size: 11616282
  split_test_data:
    cmd: python src/data_split.py data/raw/test.txt data/interim/test_features.txt
      data/interim/test_labels.txt
    deps:
    - path: data/raw/test.txt
      hash: md5
      md5: a1cab28ad8554fd9269d31e5708469d0
      size: 32724891
    - path: src/data_split.py
      hash: md5
      md5: c06a0947ef4f354295f0d5582b305208
      size: 968
    outs:
    - path: data/interim/test_features.txt
      hash: md5
      md5: 1563282b483d43739f43f425200044c5
      size: 29407738
    - path: data/interim/test_labels.txt
      hash: md5
      md5: 2e3c9d7f5cfbbbaa9ab11e95747c6b88
      size: 4045450
  split_val_data:
    cmd: python src/data_split.py data/raw/val.txt data/interim/val_features.txt data/interim/val_labels.txt
    deps:
    - path: data/raw/val.txt
      hash: md5
      md5: 7b1e28b1e91582c6f36e85517c3cc6ee
      size: 46258330
    - path: src/data_split.py
      hash: md5
      md5: c06a0947ef4f354295f0d5582b305208
      size: 968
    outs:
    - path: data/interim/val_features.txt
      hash: md5
      md5: 7d004257a712e5265a5bd985aee42979
      size: 41567033
    - path: data/interim/val_labels.txt
      hash: md5
      md5: 3c330979d7cb08758fcd9d6feaf6aa04
      size: 5721418
  tokenize_features:
    cmd: python src/tokenize_features.py data/interim/train_features.txt data/interim/val_features.txt
      data/interim/test_features.txt
    deps:
    - path: data/interim/test_features.txt
      hash: md5
      md5: 1563282b483d43739f43f425200044c5
      size: 29407738
    - path: data/interim/train_features.txt
      hash: md5
      md5: e30e89161e21482d56537c6d0889db94
      size: 84396770
    - path: data/interim/val_features.txt
      hash: md5
      md5: 7d004257a712e5265a5bd985aee42979
      size: 41567033
    - path: src/tokenize_features.py
      hash: md5
      md5: ba61bc4977e472612d7fd17189ebaf2c
      size: 1604
    outs:
    - path: data/interim/tokenized_test.txt
      hash: md5
      md5: 8edfd2cc3629bd6d67b3f652950dea09
      size: 162350139
    - path: data/interim/tokenized_train.txt
      hash: md5
      md5: ec5e6959c77d5c1770341f1ccad2dcbd
      size: 466173135
    - path: data/interim/tokenized_val.txt
      hash: md5
      md5: e182824b8fbed2204f74d4845ab48350
      size: 229605840
    - path: data/interim/tokenizer.pkl
      hash: md5
      md5: a6acd95dd7331b24cbc2fe471446556f
      size: 2425
  download_data:
    cmd: python src/data_downloader.py
    deps:
    - path: src/data_downloader.py
      hash: md5
      md5: 5a682a5c09b30709fa9815ba8618c549
      size: 1586
    outs:
    - path: data/raw/test.txt
      hash: md5
      md5: a1cab28ad8554fd9269d31e5708469d0
      size: 32724891
    - path: data/raw/train.txt
      hash: md5
      md5: 13fd241a41370119612d5b00b0433009
      size: 93921671
    - path: data/raw/val.txt
      hash: md5
      md5: 7b1e28b1e91582c6f36e85517c3cc6ee
      size: 46258330
  train_model:
    cmd: python src/train_model.py
    deps:
    - path: data/interim/encoded_train_labels.txt
      hash: md5
      md5: 9f7db0ed64bb77128caa33b3402f97b5
      size: 3137322
    - path: data/interim/encoded_val_labels.txt
      hash: md5
      md5: 36263c753dd478a0eb9165e9a5f988ae
      size: 1545237
    - path: data/interim/tokenized_train.txt
      hash: md5
      md5: ec5e6959c77d5c1770341f1ccad2dcbd
      size: 466173135
    - path: data/interim/tokenized_val.txt
      hash: md5
      md5: e182824b8fbed2204f74d4845ab48350
      size: 229605840
    - path: src/train_model.py
      hash: md5
      md5: 2da87996c3731f664d515528427205cc
      size: 2352
    params:
      params.yaml:
        batch_test: 5000
        batch_train: 5000
        categories:
        - phishing
        - legitimate
        embedding_dimension: 50
        epoch: 1
        loss_function: binary_crossentropy
        optimizer: adam
    outs:
    - path: loss_plot.svg
      hash: md5
      md5: 23a67025ab05a2f7f187e0cb6cdfc140
      size: 22489
    - path: metrics.json
      hash: md5
      md5: c3ca3ccf9b97120cb567cacbdcfec703
      size: 136
    - path: models/model.h5
      hash: md5
      md5: 3dbdc0ce64d375061a1bbb1a268d37d6
      size: 5483616
  test_model:
    cmd: python src/test_model.py
    deps:
    - path: data/interim/test_features.txt
      hash: md5
      md5: 1563282b483d43739f43f425200044c5
      size: 29407738
    - path: data/interim/test_labels.txt
      hash: md5
      md5: 2e3c9d7f5cfbbbaa9ab11e95747c6b88
      size: 4045450
    - path: models/best_model.keras
      hash: md5
      md5: 0abe882e92de1e1ad31d035e5404dd8b
      size: 5472086
    - path: src/test_model.py
      hash: md5
      md5: b032838a636debd8443a4ce88e8c3907
      size: 1571
    outs:
    - path: reports/classification_report.txt
      hash: md5
      md5: 34163a06bc8eeaa393c4493d37b4d5ca
      size: 358
    - path: reports/confusion_matrix.txt
      hash: md5
      md5: 942b71c0fd9b2a8494ae6250dad222ff
      size: 54
    - path: reports/test_accuracy.txt
      hash: md5
      md5: f34571f372f5b5f1f83b18e1e1be2c3c
      size: 35
    - path: reports/test_loss.txt
      hash: md5
      md5: a53929c73b51b04e2fac11219718804e
      size: 32
